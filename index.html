<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>SIGMA Bingo Online</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#111;color:#eee;text-align:center;position:relative;}
h1{margin-top:20px;letter-spacing:3px;}
button{
  padding:6px 12px;
  margin:4px;
  background:#8e44ad;
  border:none;
  color:#fff;
  cursor:pointer;
  border-radius:12px;
  font-size:14px;
  min-width:80px;
}
.tabs{
  position:absolute;
  top:10px;
  right:10px;
  display:flex;
  flex-direction:column;
}
table{margin:auto;border-collapse:collapse;margin-top:60px;}
td{width:140px;height:90px;border:2px solid #444;cursor:pointer;padding:6px;}
td.checked{background:#8e44ad;text-decoration:line-through;}
#win{display:none;font-size:28px;color:#f39c12;margin:10px;}
.panel{margin:12px auto;padding:12px;border:1px solid #333;border-radius:6px;width:85%;}
input{padding:6px;border-radius:6px;border:none;width:220px;font-size:14px;}
</style>
</head>
<body>

<h1>üê∫ SIGMA Bingo Online</h1>

<div class="tabs">
  <button id="tabBingo">Bingo</button>
  <button id="tabAdmin">Admin</button>
</div>

<div id="bingoTab" class="tab section">
  <div class="panel">
    <div id="win">üèÜ WYGRANA ‚Äì 3 LINIE üèÜ</div>
    <table id="bingo"></table>
  </div>
</div>

<div id="adminTab" class="tab section" style="display:none">
  <div class="panel">
    <input id="adminPin" type="password" placeholder="PIN admina">
    <button id="btnAdminLogin" type="button">Zaloguj</button>
    <div id="adminPanel" style="display:none;margin-top:12px">
      <input id="taskIn" placeholder="Dodaj zadanie">
      <button id="btnAddTask" type="button">Dodaj</button>
      <button id="btnClearTasks" type="button">Wyczy≈õƒá zadania</button>
      <p id="taskCount"></p>
    </div>
  </div>
</div>

<script>
const ADMIN_PIN = "1413";
let isAdmin = false;
let cells = [];
let tasks = []; // lista zada≈Ñ lokalnie

// ---------- OBS≈ÅUGA ZDARZE≈É ----------
document.getElementById("tabBingo").addEventListener("click", ()=>switchTab('bingo'));
document.getElementById("tabAdmin").addEventListener("click", ()=>switchTab('admin'));
document.getElementById("btnAdminLogin").addEventListener("click", loginAdmin);
document.getElementById("btnAddTask").addEventListener("click", addTask);
document.getElementById("btnClearTasks").addEventListener("click", clearAllTasks);

// ---------- SWITCH TAB ----------
function switchTab(name){
  document.querySelectorAll('.tab.section').forEach(s=>s.style.display='none');
  document.getElementById(name+'Tab').style.display='block';
  document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active'));
  document.getElementById("tab"+name.charAt(0).toUpperCase()+name.slice(1)).classList.add("active");

  if(name==='bingo') loadTasks();
}

// ---------- BINGO ----------
function loadTasks(){
  if(tasks.length < 25){ 
    document.getElementById("bingo").innerHTML="";
    alert("Admin musi dodaƒá min. 25 zada≈Ñ"); 
    return; 
  }
  bingoBoard(tasks);
}

function bingoBoard(taskArray){
  const picked = [...taskArray].sort(()=>Math.random()-0.5).slice(0,25);
  cells = [];
  document.getElementById("win").style.display="none";
  const table = document.getElementById("bingo");
  table.innerHTML = "";
  let idx=0;
  for(let r=0;r<5;r++){
    let tr = document.createElement("tr");
    for(let c=0;c<5;c++){
      let td = document.createElement("td");
      td.textContent = picked[idx++];
      td.addEventListener("click", ()=>{
        td.classList.toggle("checked");
        checkWin();
      });
      cells.push(td);
      tr.appendChild(td);
    }
    table.appendChild(tr);
  }
}

function checkWin(){
  let wins=0;
  for(let r=0;r<5;r++) if([0,1,2,3,4].every(c=>cells[r*5+c].classList.contains("checked"))) wins++;
  for(let c=0;c<5;c++) if([0,1,2,3,4].every(r=>cells[r*5+c].classList.contains("checked"))) wins++;
  if([0,6,12,18,24].every(i=>cells[i].classList.contains("checked"))) wins++;
  if([4,8,12,16,20].every(i=>cells[i].classList.contains("checked"))) wins++;
  if(wins>=3){
    document.getElementById("win").style.display="block";
  }
}

// ---------- ADMIN ----------
function loginAdmin(){
  const pin = document.getElementById("adminPin").value.trim();
  if(pin===ADMIN_PIN){
    isAdmin=true;
    document.getElementById("adminPanel").style.display="block";
    updateTaskCount();
  } else {
    alert("Z≈Çy PIN!");
    document.getElementById("adminPanel").style.display="none";
  }
}

function addTask(){
  if(!isAdmin) return;
  const txt = document.getElementById("taskIn").value.trim();
  if(!txt) return;
  tasks.push(txt);
  document.getElementById("taskIn").value="";
  updateTaskCount();
}

function clearAllTasks(){
  if(!isAdmin) return;
  if(confirm("UsunƒÖƒá wszystkie zadania?")){
    tasks = [];
  }
  updateTaskCount();
}

function updateTaskCount(){
  document.getElementById("taskCount").textContent="Liczba zada≈Ñ: "+tasks.length;
}
</script>
</body>
</html>
